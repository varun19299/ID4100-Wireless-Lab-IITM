<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Principles and Techniques of Data Science</title>
  <meta name="description" content="This is the textbook for Data 100, the Principles and Techniques of Data Science course at UC Berkeley.
Data 100 is the upper-division, semester-long data science course that follows Data 8, the Foundations of Data Science. The reader's assumed background is detailed in the About This Book page.">

  <link rel="canonical" href="/ch/05/cleaning_calls.html">
  <link rel="alternate" type="application/rss+xml" title="Principles and Techniques of Data Science" href="/feed.xml">

  <meta property="og:url"         content="/ch/05/cleaning_calls.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Principles and Techniques of Data Science" />
<meta property="og:description" content="This is the textbook for Data 100, the Principles and Techniques of Data Science course at UC Berkeley.
Data 100 is the upper-division, semester-long data science course that follows Data 8, the Foundations of Data Science. The reader's assumed background is detailed in the About This Book page." />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "/ch/05/cleaning_calls.html",
  "headline":
    "Principles and Techniques of Data Science",
  "datePublished":
    "2019-03-03T19:56:01+05:30",
  "dateModified":
    "2019-03-03T19:56:01+05:30",
  "description":
    "This is the textbook for Data 100, the Principles and Techniques of Data Science course at UC Berkeley.
Data 100 is the upper-division, semester-long data science course that follows Data 8, the Foundations of Data Science. The reader's assumed background is detailed in the About This Book page.",
  "author": {
    "@type": "Person",
    "name": "Sam Lau, Joey Gonzalez, and Deborah Nolan"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "",
    "height": 60,
    "width": 60
  }
}

  </script>

  <link rel="stylesheet" href="/assets/css/styles.css">

  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Allow inline math using $ and automatically break long math lines -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
      },
      CommonHTML: {
        linebreaks: {
          automatic: true,
        },
      },
    });
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/assets/js/turbolinks.js" async></script>

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Google analytics -->
  <script src="/assets/js/ga.js" async></script>
</head>

  <body>
    <!-- Show sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      




<nav id="js-sidebar" class="c-textbook__sidebar">
  <ul class="c-sidebar__chapters">
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="http://ds100.org/"
        >
          
          Data 100 Homepage
        </a>

        
      </li>

      
    

      
      
        <li class="c-sidebar__divider"></li>
        

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/"
        >
          
          Introduction
        </a>

        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/about_this_book.html"
        >
          
          About This Book
        </a>

        
      </li>

      
    

      
      
        <li class="c-sidebar__divider"></li>
        

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/01/lifecycle_intro.html"
        >
          
            1.
          
          The Data Science Lifecycle
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/01/lifecycle_students_1.html"
                >
                  
                    1.1
                    
                  
                  The Students of Data 100
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/01/lifecycle_students_2.html"
                >
                  
                    1.2
                    
                  
                  Exploring the Data
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/01/lifecycle_students_3.html"
                >
                  
                    1.3
                    
                  
                  What's in a Name?
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/02/design_intro.html"
        >
          
            2.
          
          Data Design
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/02/design_dewey_truman.html"
                >
                  
                    2.1
                    
                  
                  Dewey Defeats Truman
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/02/design_prob_overview.html"
                >
                  
                    2.2
                    
                  
                  Probability Overview
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/02/design_sampling.html"
                >
                  
                    2.3
                    
                  
                  Probability Sampling
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/02/design_srs_vs_big_data.html"
                >
                  
                    2.4
                    
                  
                  SRS vs. "Big Data"
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/03/pandas_intro.html"
        >
          
            3.
          
          Tabular Data and pandas
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/03/pandas_structure.html"
                >
                  
                    3.1
                    
                  
                  Structure
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/03/pandas_indexes.html"
                >
                  
                    3.2
                    
                  
                  Indexes, Slicing, and Sorting
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/03/pandas_grouping_pivoting.html"
                >
                  
                    3.3
                    
                  
                  Grouping and Pivoting
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/03/pandas_apply_strings_plotting.html"
                >
                  
                    3.4
                    
                  
                  Apply, Strings, and Plotting
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/04/eda_intro.html"
        >
          
            4.
          
          Exploratory Data Analysis
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/04/eda_data_types.html"
                >
                  
                    4.1
                    
                  
                  Data Types
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href=""
                >
                  
                    4.2
                    
                  
                  Distributions [in progress]
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href=""
                >
                  
                    4.3
                    
                  
                  Associations [in progress]
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/05/cleaning_intro.html"
        >
          
            5.
          
          Data Cleaning
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/ch/05/cleaning_calls.html"
                >
                  
                    5.1
                    
                  
                  Cleaning the Calls Dataset
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_stops.html"
                >
                  
                    5.2
                    
                  
                  Cleaning the Stops Dataset
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_structure.html"
                >
                  
                    5.3
                    
                  
                  Structure and Joins
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_granularity.html"
                >
                  
                    5.4
                    
                  
                  Granularity
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_scope.html"
                >
                  
                    5.5
                    
                  
                  Scope
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_temp.html"
                >
                  
                    5.6
                    
                  
                  Temporality
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_faithfulness.html"
                >
                  
                    5.7
                    
                  
                  Faithfulness
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/06/viz_intro.html"
        >
          
            6.
          
          Data Visualization
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_quantitative.html"
                >
                  
                    6.1
                    
                  
                  Quantitative Data
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_qualitative.html"
                >
                  
                    6.2
                    
                  
                  Qualitative Data
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_matplotlib.html"
                >
                  
                    6.3
                    
                  
                  Customizing Plots
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_principles.html"
                >
                  
                    6.4
                    
                  
                  Principles of Visualization
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_principles_2.html"
                >
                  
                    6.5
                    
                  
                  Principles of Visualization 2
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_philosophy.html"
                >
                  
                    6.6
                    
                  
                  Visualization Philosophy
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/07/web_intro.html"
        >
          
            7.
          
          Web Technologies
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/07/web_http.html"
                >
                  
                    7.1
                    
                  
                  HTTP
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/08/text_intro.html"
        >
          
            8.
          
          Working With Text
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/08/text_strings.html"
                >
                  
                    8.1
                    
                  
                  Python String Methods
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/08/text_regex.html"
                >
                  
                    8.2
                    
                  
                  Regular Expressions
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/08/text_re.html"
                >
                  
                    8.3
                    
                  
                  Regex in Python and pandas
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/09/sql_intro.html"
        >
          
            9.
          
          Databases and SQL
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/09/sql_rdbms.html"
                >
                  
                    9.1
                    
                  
                  Relational Databases
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/09/sql_basics.html"
                >
                  
                    9.2
                    
                  
                  SQL Queries
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/09/sql_joins.html"
                >
                  
                    9.3
                    
                  
                  SQL Joins
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/10/modeling_intro.html"
        >
          
            10.
          
          Modeling and Estimation
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/10/modeling_simple.html"
                >
                  
                    10.1
                    
                  
                  A Simple Model
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/10/modeling_loss_functions.html"
                >
                  
                    10.2
                    
                  
                  Loss Functions
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/10/modeling_abs_huber.html"
                >
                  
                    10.3
                    
                  
                  Absolute Cost and Huber Cost
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/11/gradient_descent.html"
        >
          
            11.
          
          Gradient Descent
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/11/gradient_basics.html"
                >
                  
                    11.1
                    
                  
                  Basic Numerical Optimization
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/11/gradient_descent_define.html"
                >
                  
                    11.2
                    
                  
                  Defining Gradient Descent
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/11/gradient_convexity.html"
                >
                  
                    11.3
                    
                  
                  Convexity
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/11/gradient_stochastic.html"
                >
                  
                    11.4
                    
                  
                  Stochastic Gradient Descent
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/12/prob_and_gen.html"
        >
          
            12.
          
          Probability and Generalization
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/12/prob_random_vars.html"
                >
                  
                    12.1
                    
                  
                  Random Variables
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/12/prob_exp_var.html"
                >
                  
                    12.2
                    
                  
                  Expectation and Variance
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/12/prob_risk.html"
                >
                  
                    12.3
                    
                  
                  Risk
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/13/linear_models.html"
        >
          
            13.
          
          Linear Regression
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/13/linear_tips.html"
                >
                  
                    13.1
                    
                  
                  Defining a Simple Linear Model
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/13/linear_grad.html"
                >
                  
                    13.2
                    
                  
                  Fitting the Model
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/13/linear_multiple.html"
                >
                  
                    13.3
                    
                  
                  Multiple Linear Regression
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/13/linear_projection.html"
                >
                  
                    13.4
                    
                  
                  A Geometric Perspective
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/13/linear_case_study.html"
                >
                  
                    13.5
                    
                  
                  Linear Regression Case Study
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/14/feature_engineering.html"
        >
          
            14.
          
          Feature Engineering
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/14/feature_one_hot.html"
                >
                  
                    14.1
                    
                  
                  One-Hot Encoding
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/14/feature_polynomial.html"
                >
                  
                    14.2
                    
                  
                  Polynomial Regression
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/15/bias_intro.html"
        >
          
            15.
          
          Bias-Variance Tradeoff
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/15/bias_risk.html"
                >
                  
                    15.1
                    
                  
                  Risk and Cost Minimization
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/15/bias_modeling.html"
                >
                  
                    15.2
                    
                  
                  Model Bias and Variance
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/15/bias_cv.html"
                >
                  
                    15.3
                    
                  
                  Cross Validation
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/16/reg_intro.html"
        >
          
            16.
          
          Regularization
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/16/reg_intuition.html"
                >
                  
                    16.1
                    
                  
                  Regularization Intuition
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/16/reg_ridge.html"
                >
                  
                    16.2
                    
                  
                  L2 Regularization
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/16/reg_lasso.html"
                >
                  
                    16.3
                    
                  
                  L1 Regularization
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/17/classification_intro.html"
        >
          
            17.
          
          Classification
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_prob.html"
                >
                  
                    17.1
                    
                  
                  Regression on Probabilities
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_log_model.html"
                >
                  
                    17.2
                    
                  
                  Logistic Model
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_cost.html"
                >
                  
                    17.3
                    
                  
                  Cross-Entropy Loss
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_log_reg.html"
                >
                  
                    17.4
                    
                  
                  Using Logistic Regression
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_cost_justification.html"
                >
                  
                    17.5
                    
                  
                  Justifying Cross-Entropy Loss
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_sgd.html"
                >
                  
                    17.6
                    
                  
                  Fitting a Logistic Model
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_sensitivity_specificity.html"
                >
                  
                    17.7
                    
                  
                  Evaluating Logistic Models
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_multiclass.html"
                >
                  
                    17.8
                    
                  
                  Multiclass Classification
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/18/hyp_intro.html"
        >
          
            18.
          
          Statistical Inference
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/18/hyp_introduction.html"
                >
                  
                    18.1
                    
                  
                  Introduction to Hypothesis Testing
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/18/hyp_introduction_part2.html"
                >
                  
                    18.2
                    
                  
                  Permutation Testing
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/18/hyp_regression.html"
                >
                  
                    18.3
                    
                  
                  Bootstrapping for Linear Regression
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/18/hyp_studentized.html"
                >
                  
                    18.4
                    
                  
                  Studentized Bootstrap
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/18/hyp_phacking.html"
                >
                  
                    18.5
                    
                  
                  P-Hacking
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      
        <li class="c-sidebar__divider"></li>
        

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/19/vector_space_review.html"
        >
          
          Appendix: Vector Space Review
        </a>

        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/20/ref_intro.html"
        >
          
          Appendix: Reference Tables
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/20/ref_pandas.html"
                >
                  
                  pandas
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/20/ref_seaborn.html"
                >
                  
                  seaborn
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/20/ref_matplotlib.html"
                >
                  
                  matplotlib
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/20/ref_sklearn.html"
                >
                  
                  scikit-learn
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/21/contributors.html"
        >
          
          Appendix: Contributors
        </a>

        
      </li>

      
    
  </ul>
</nav>


      <main class="c-textbook__page" tabindex="-1">
        <div class="o-wrapper c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

        <div class="o-wrapper">
          

<div id="ipython-notebook">
    <div class="buttons">
        <button class="interact-button js-nbinteract-widget">
            Show Widgets
        </button>
        <a class="interact-button" href="http://data100.datahub.berkeley.edu/user-redirect/git-pull?repo=https://github.com/DS-100/textbook&subPath=notebooks/05/cleaning_calls.ipynb">Open on DataHub</a>
    </div>
    







  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/notebooks/05&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

  </div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c1"># Ignore numpy dtype warnings. These warnings are caused by an interaction</span>
<span class="c1"># between numpy and Cython and can be safely ignored.</span>
<span class="c1"># Reference: https://stackoverflow.com/a/40846742</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;numpy.dtype size changed&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;numpy.ufunc size changed&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option(&#39;display.float_format&#39;, &#39;{:.2f}&#39;.format)</span>
</pre></div>

    </div>
</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Investigating-Berkeley-Police-Data">Investigating Berkeley Police Data<a class="anchor-link" href="#Investigating-Berkeley-Police-Data">&#182;</a></h2><p>We will use the Berkeley Police Department's publicly available datasets to demonstrate data cleaning techniques. We have downloaded the <a href="https://data.cityofberkeley.info/Public-Safety/Berkeley-PD-Calls-for-Service/k2nh-s5h5">Calls for Service dataset</a> and <a href="https://data.cityofberkeley.info/Public-Safety/Berkeley-PD-Stop-Data/6e9j-pj9p">Stops dataset</a>.</p>
<p>We can use the <code>ls</code> shell command with the <code>-lh</code> flags to see more details about the files:</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls -lh data/
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    

<div class="output_subarea output_stream output_stdout output_text">
<pre>total 13936
-rw-r--r--@ 1 sam  staff   979K Aug 29 14:41 Berkeley_PD_-_Calls_for_Service.csv
-rw-r--r--@ 1 sam  staff    81B Aug 29 14:28 cvdow.csv
-rw-r--r--@ 1 sam  staff   5.8M Aug 29 14:41 stops.json
</pre>
</div>
</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The command above shows the data files and their file sizes. This is especially useful because we now know the files are small enough to load into memory. As a rule of thumb, it is usually safe to load a file into memory that is around one fourth of the total memory capacity of the computer. For example, if a computer has 4GB of RAM we should be able to load a 1GB CSV file in <code>pandas</code>. To handle larger datasets we will need additional computational tools that we will cover later in this book.</p>
<p>Notice the use of the exclamation point before <code>ls</code>. This tells Jupyter that the next line of code is a shell command, not a Python expression. We can run any available shell command in Jupyter using <code>!</code>:</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># The `wc` shell command shows us how many lines each file has.</span>
<span class="c1"># We can see that the `stops.json` file has the most lines (29852).</span>
<span class="o">!</span>wc -l data/*
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    

<div class="output_subarea output_stream output_stdout output_text">
<pre>   16497 data/Berkeley_PD_-_Calls_for_Service.csv
       8 data/cvdow.csv
   29852 data/stops.json
   46357 total
</pre>
</div>
</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Understanding-the-Data-Generation">Understanding the Data Generation<a class="anchor-link" href="#Understanding-the-Data-Generation">&#182;</a></h3><p>We will state important questions you should ask of all datasets before data cleaning or processing. These questions are related to how the data were generated, so data cleaning will usually <strong>not</strong> be able to resolve issues that arise here.</p>
<p><strong>What do the data contain?</strong> The website for the Calls for Service data states that the dataset describes "crime incidents (not criminal reports) within the last 180 days". Further reading reveals that "not all calls for police service are included (e.g. Animal Bite)".</p>
<p>The website for the Stops data states that the dataset contains data on all "vehicle detentions (including bicycles) and pedestrian detentions (up to five persons)" since January 26, 2015.</p>
<p><strong>Are the data a census?</strong> This depends on our population of interest. For example, if we are interested in calls for service within the last 180 days for crime incidents then the Calls dataset is a census. However, if we are interested in calls for service within the last 10 years the dataset is clearly not a census. We can make similar statements about the Stops dataset since the data collection started on January 26, 2015.</p>
<p><strong>If the data form a sample, is it a probability sample?</strong> If we are investigating a period of time that the data do not have entries for, the data do not form a probability sample since there is no randomness involved in the data collection process  we have all data for certain time periods but no data for others.</p>
<p><strong>What limitations will this data have on our conclusions?</strong> Although we will ask this question at each step of our data processing, we can already see that our data impose important limitations. The most important limitation is that we cannot make unbiased estimations for time periods not covered by our datasets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cleaning-The-Calls-Dataset">Cleaning The Calls Dataset<a class="anchor-link" href="#Cleaning-The-Calls-Dataset">&#182;</a></h2><p>Let's now clean the Calls dataset. The <code>head</code> shell command prints the first five lines of the file.</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head data/Berkeley_PD_-_Calls_for_Service.csv
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    

<div class="output_subarea output_stream output_stdout output_text">
<pre>CASENO,OFFENSE,EVENTDT,EVENTTM,CVLEGEND,CVDOW,InDbDate,Block_Location,BLKADDR,City,State
17091420,BURGLARY AUTO,07/23/2017 12:00:00 AM,06:00,BURGLARY - VEHICLE,0,08/29/2017 08:28:05 AM,&#34;2500 LE CONTE AVE
Berkeley, CA
(37.876965, -122.260544)&#34;,2500 LE CONTE AVE,Berkeley,CA
17020462,THEFT FROM PERSON,04/13/2017 12:00:00 AM,08:45,LARCENY,4,08/29/2017 08:28:00 AM,&#34;2200 SHATTUCK AVE
Berkeley, CA
(37.869363, -122.268028)&#34;,2200 SHATTUCK AVE,Berkeley,CA
17050275,BURGLARY AUTO,08/24/2017 12:00:00 AM,18:30,BURGLARY - VEHICLE,4,08/29/2017 08:28:06 AM,&#34;200 UNIVERSITY AVE
Berkeley, CA
(37.865491, -122.310065)&#34;,200 UNIVERSITY AVE,Berkeley,CA
</pre>
</div>
</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It appears to be a comma-separated values (CSV) file, though it's hard to tell whether the entire file is formatted properly. We can use <code>pd.read_csv</code> to read in the file as a DataFrame. If <code>pd.read_csv</code> errors, we will have to dig deeper and manually resolve formatting issues. Fortunately, <code>pd.read_csv</code> successfully returns a DataFrame:</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/Berkeley_PD_-_Calls_for_Service.csv&#39;</span><span class="p">)</span>
<span class="n">calls</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>Block_Location</th>
      <th>BLKADDR</th>
      <th>City</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17091420</td>
      <td>BURGLARY AUTO</td>
      <td>07/23/2017 12:00:00 AM</td>
      <td>06:00</td>
      <td>...</td>
      <td>2500 LE CONTE AVE\nBerkeley, CA\n(37.876965, -...</td>
      <td>2500 LE CONTE AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17020462</td>
      <td>THEFT FROM PERSON</td>
      <td>04/13/2017 12:00:00 AM</td>
      <td>08:45</td>
      <td>...</td>
      <td>2200 SHATTUCK AVE\nBerkeley, CA\n(37.869363, -...</td>
      <td>2200 SHATTUCK AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17050275</td>
      <td>BURGLARY AUTO</td>
      <td>08/24/2017 12:00:00 AM</td>
      <td>18:30</td>
      <td>...</td>
      <td>200 UNIVERSITY AVE\nBerkeley, CA\n(37.865491, ...</td>
      <td>200 UNIVERSITY AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5505</th>
      <td>17018126</td>
      <td>DISTURBANCE</td>
      <td>04/01/2017 12:00:00 AM</td>
      <td>12:22</td>
      <td>...</td>
      <td>1600 FAIRVIEW ST\nBerkeley, CA\n(37.850001, -1...</td>
      <td>1600 FAIRVIEW ST</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>5506</th>
      <td>17090665</td>
      <td>THEFT MISD. (UNDER $950)</td>
      <td>04/01/2017 12:00:00 AM</td>
      <td>12:00</td>
      <td>...</td>
      <td>2000 DELAWARE ST\nBerkeley, CA\n(37.874489, -1...</td>
      <td>2000 DELAWARE ST</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>5507</th>
      <td>17049700</td>
      <td>SEXUAL ASSAULT MISD.</td>
      <td>08/22/2017 12:00:00 AM</td>
      <td>20:02</td>
      <td>...</td>
      <td>2400 TELEGRAPH AVE\nBerkeley, CA\n(37.866761, ...</td>
      <td>2400 TELEGRAPH AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
  </tbody>
</table>
<p>5508 rows  11 columns</p>
</div>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can define a function to show different slices of the data and then interact with it:</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="mi">6</span><span class="p">]</span>
    <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="mi">5</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">df_interact</span><span class="p">(</span><span class="n">calls</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    



  <div class="output_subarea output_widget_view ">
    <button class="js-nbinteract-widget">
      Loading widgets...
    </button>
  </div>

</div>

<div class="output_area">

    

<div class="output_subarea output_stream output_stdout output_text">
<pre>(5508 rows, 11 columns) total
</pre>
</div>
</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Based on the output above, the resulting DataFrame looks reasonably well-formed since the columns are properly named and the data in each column seems to be entered consistently. What data does each column contain? We can look at the dataset website:</p>
<table>
<thead><tr>
<th>Column</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>CASENO</td>
<td>Case Number</td>
<td>Number</td>
</tr>
<tr>
<td>OFFENSE</td>
<td>Offense Type</td>
<td>Plain Text</td>
</tr>
<tr>
<td>EVENTDT</td>
<td>Date Event Occurred</td>
<td>Date &amp; Time</td>
</tr>
<tr>
<td>EVENTTM</td>
<td>Time Event Occurred</td>
<td>Plain Text</td>
</tr>
<tr>
<td>CVLEGEND</td>
<td>Description of Event</td>
<td>Plain Text</td>
</tr>
<tr>
<td>CVDOW</td>
<td>Day of Week Event Occurred</td>
<td>Number</td>
</tr>
<tr>
<td>InDbDate</td>
<td>Date dataset was updated in the portal</td>
<td>Date &amp; Time</td>
</tr>
<tr>
<td>Block_Location</td>
<td>Block level address of event</td>
<td>Location</td>
</tr>
<tr>
<td>BLKADDR</td>
<td></td>
<td>Plain Text</td>
</tr>
<tr>
<td>City</td>
<td></td>
<td>Plain Text</td>
</tr>
<tr>
<td>State</td>
<td></td>
<td>Plain Text</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On the surface the data looks easy to work with. However, before starting data analysis we must answer the following questions:</p>
<ol>
<li><strong>Are there missing values in the dataset?</strong> This question is important because missing values can represent many different things. For example, missing addresses could mean that locations were removed to protect anonymity, or that some respondents chose not to answer a survey question, or that a recording device broke.</li>
<li><strong>Are there any missing values that were filled in (e.g. a 999 for unknown age or 12:00am for unknown date)?</strong> These will clearly impact analysis if we ignore them.</li>
<li><strong>Which parts of the data were entered by a human?</strong> As we will soon see, human-entered data is filled with inconsistencies and mispellings.</li>
</ol>
<p>Although there are plenty more checks to go through, these three will suffice for many cases. See the <a href="https://github.com/Quartz/bad-data-guide">Quartz bad data guide</a> for a more complete list of checks.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Are-there-missing-values?">Are there missing values?<a class="anchor-link" href="#Are-there-missing-values?">&#182;</a></h3><p>This is a simple check in <code>pandas</code>:</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># True if row contains at least one null value</span>
<span class="n">null_rows</span> <span class="o">=</span> <span class="n">calls</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">calls</span><span class="p">[</span><span class="n">null_rows</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>Block_Location</th>
      <th>BLKADDR</th>
      <th>City</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>116</th>
      <td>17014831</td>
      <td>BURGLARY AUTO</td>
      <td>03/16/2017 12:00:00 AM</td>
      <td>22:00</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>478</th>
      <td>17042511</td>
      <td>BURGLARY AUTO</td>
      <td>07/20/2017 12:00:00 AM</td>
      <td>16:00</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>486</th>
      <td>17022572</td>
      <td>VEHICLE STOLEN</td>
      <td>04/22/2017 12:00:00 AM</td>
      <td>21:00</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4945</th>
      <td>17091287</td>
      <td>VANDALISM</td>
      <td>07/01/2017 12:00:00 AM</td>
      <td>08:00</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>4947</th>
      <td>17038382</td>
      <td>BURGLARY RESIDENTIAL</td>
      <td>06/30/2017 12:00:00 AM</td>
      <td>15:00</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>5167</th>
      <td>17091632</td>
      <td>VANDALISM</td>
      <td>08/15/2017 12:00:00 AM</td>
      <td>23:30</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
  </tbody>
</table>
<p>27 rows  11 columns</p>
</div>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like 27 calls didn't have a recorded address in BLKADDR. Unfortunately, the data description isn't very clear on how the locations were recorded. We know that all of these calls were made for events in Berkeley, so we can likely assume that the addresses for these calls were originally somewhere in Berkeley.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Are-there-any-missing-values-that-were-filled-in?">Are there any missing values that were filled in?<a class="anchor-link" href="#Are-there-any-missing-values-that-were-filled-in?">&#182;</a></h3><p>From the missing value check above we can see that the Block_Location column has Berkeley, CA recorded if the location was missing.</p>
<p>In addition, an inspection of the <code>calls</code> table shows us that the EVENTDT column has the correct dates but records 12am for all of its times. Instead, the times are in the EVENTTM column.</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Show the first 7 rows of the table again for reference</span>
<span class="n">calls</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>Block_Location</th>
      <th>BLKADDR</th>
      <th>City</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17091420</td>
      <td>BURGLARY AUTO</td>
      <td>07/23/2017 12:00:00 AM</td>
      <td>06:00</td>
      <td>...</td>
      <td>2500 LE CONTE AVE\nBerkeley, CA\n(37.876965, -...</td>
      <td>2500 LE CONTE AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17020462</td>
      <td>THEFT FROM PERSON</td>
      <td>04/13/2017 12:00:00 AM</td>
      <td>08:45</td>
      <td>...</td>
      <td>2200 SHATTUCK AVE\nBerkeley, CA\n(37.869363, -...</td>
      <td>2200 SHATTUCK AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17050275</td>
      <td>BURGLARY AUTO</td>
      <td>08/24/2017 12:00:00 AM</td>
      <td>18:30</td>
      <td>...</td>
      <td>200 UNIVERSITY AVE\nBerkeley, CA\n(37.865491, ...</td>
      <td>200 UNIVERSITY AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17019145</td>
      <td>GUN/WEAPON</td>
      <td>04/06/2017 12:00:00 AM</td>
      <td>17:30</td>
      <td>...</td>
      <td>1900 SEVENTH ST\nBerkeley, CA\n(37.869318, -12...</td>
      <td>1900 SEVENTH ST</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17044993</td>
      <td>VEHICLE STOLEN</td>
      <td>08/01/2017 12:00:00 AM</td>
      <td>18:00</td>
      <td>...</td>
      <td>100 PARKSIDE DR\nBerkeley, CA\n(37.854247, -12...</td>
      <td>100 PARKSIDE DR</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>5</th>
      <td>17037319</td>
      <td>BURGLARY RESIDENTIAL</td>
      <td>06/28/2017 12:00:00 AM</td>
      <td>12:00</td>
      <td>...</td>
      <td>1500 PRINCE ST\nBerkeley, CA\n(37.851503, -122...</td>
      <td>1500 PRINCE ST</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>6</th>
      <td>17030791</td>
      <td>BURGLARY RESIDENTIAL</td>
      <td>05/30/2017 12:00:00 AM</td>
      <td>08:45</td>
      <td>...</td>
      <td>300 MENLO PL\nBerkeley, CA\n</td>
      <td>300 MENLO PL</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
  </tbody>
</table>
<p>7 rows  11 columns</p>
</div>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As a data cleaning step, we want to merge the EVENTDT and EVENTTM columns to record both date and time in one field. If we define a function that takes in a DF and returns a new DF, we can later use <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pipe.html"><code>pd.pipe</code></a> to apply all transformations in one go.</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">combine_event_datetimes</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="n">combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span>
        <span class="c1"># Combine date and time strings</span>
        <span class="n">calls</span><span class="p">[</span><span class="s1">&#39;EVENTDT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">calls</span><span class="p">[</span><span class="s1">&#39;EVENTTM&#39;</span><span class="p">],</span>
        <span class="n">infer_datetime_format</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">EVENTDTTM</span><span class="o">=</span><span class="n">combined</span><span class="p">)</span>

<span class="c1"># To peek at the result without mutating the calls DF:</span>
<span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">combine_event_datetimes</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>BLKADDR</th>
      <th>City</th>
      <th>State</th>
      <th>EVENTDTTM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17091420</td>
      <td>BURGLARY AUTO</td>
      <td>07/23/2017 12:00:00 AM</td>
      <td>06:00</td>
      <td>...</td>
      <td>2500 LE CONTE AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>2017-07-23 06:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17020462</td>
      <td>THEFT FROM PERSON</td>
      <td>04/13/2017 12:00:00 AM</td>
      <td>08:45</td>
      <td>...</td>
      <td>2200 SHATTUCK AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>2017-04-13 08:45:00</td>
    </tr>
  </tbody>
</table>
<p>2 rows  12 columns</p>
</div>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Which-parts-of-the-data-were-entered-by-a-human?">Which parts of the data were entered by a human?<a class="anchor-link" href="#Which-parts-of-the-data-were-entered-by-a-human?">&#182;</a></h3><p>It looks like most of the data columns are machine-recorded, including the date, time, day of week, and location of the event.</p>
<p>In addition, the OFFENSE and CVLEGEND columns appear to contain consistent values. We can check the unique values in each column to see if anything was misspelled:</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;OFFENSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;BURGLARY AUTO&#39;, &#39;THEFT FROM PERSON&#39;, &#39;GUN/WEAPON&#39;,
       &#39;VEHICLE STOLEN&#39;, &#39;BURGLARY RESIDENTIAL&#39;, &#39;VANDALISM&#39;,
       &#39;DISTURBANCE&#39;, &#39;THEFT MISD. (UNDER $950)&#39;, &#39;THEFT FROM AUTO&#39;,
       &#39;DOMESTIC VIOLENCE&#39;, &#39;THEFT FELONY (OVER $950)&#39;, &#39;ALCOHOL OFFENSE&#39;,
       &#39;MISSING JUVENILE&#39;, &#39;ROBBERY&#39;, &#39;IDENTITY THEFT&#39;,
       &#39;ASSAULT/BATTERY MISD.&#39;, &#39;2ND RESPONSE&#39;, &#39;BRANDISHING&#39;,
       &#39;MISSING ADULT&#39;, &#39;NARCOTICS&#39;, &#39;FRAUD/FORGERY&#39;,
       &#39;ASSAULT/BATTERY FEL.&#39;, &#39;BURGLARY COMMERCIAL&#39;, &#39;MUNICIPAL CODE&#39;,
       &#39;ARSON&#39;, &#39;SEXUAL ASSAULT FEL.&#39;, &#39;VEHICLE RECOVERED&#39;,
       &#39;SEXUAL ASSAULT MISD.&#39;, &#39;KIDNAPPING&#39;, &#39;VICE&#39;, &#39;HOMICIDE&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

  </div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;CVLEGEND&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;BURGLARY - VEHICLE&#39;, &#39;LARCENY&#39;, &#39;WEAPONS OFFENSE&#39;,
       &#39;MOTOR VEHICLE THEFT&#39;, &#39;BURGLARY - RESIDENTIAL&#39;, &#39;VANDALISM&#39;,
       &#39;DISORDERLY CONDUCT&#39;, &#39;LARCENY - FROM VEHICLE&#39;, &#39;FAMILY OFFENSE&#39;,
       &#39;LIQUOR LAW VIOLATION&#39;, &#39;MISSING PERSON&#39;, &#39;ROBBERY&#39;, &#39;FRAUD&#39;,
       &#39;ASSAULT&#39;, &#39;NOISE VIOLATION&#39;, &#39;DRUG VIOLATION&#39;,
       &#39;BURGLARY - COMMERCIAL&#39;, &#39;ALL OTHER OFFENSES&#39;, &#39;ARSON&#39;, &#39;SEX CRIME&#39;,
       &#39;RECOVERED VEHICLE&#39;, &#39;KIDNAPPING&#39;, &#39;HOMICIDE&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since each value in these columns appears to be spelled correctly, we won't have to perform any corrections on these columns.</p>
<p>We also check the BLKADDR column for inconsistencies and find that sometimes an address is recorded (e.g. 2500 LE CONTE AVE) but other times a cross street is recorded (e.g. ALLSTON WAY &amp; FIFTH ST). This suggests that a human entered this data in and this column will be difficult to use for analysis. Fortunately we can use the latitude and longitude of the event instead of the street address.</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;BLKADDR&#39;</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5001</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    



<div class="output_text output_subarea output_execute_result">
<pre>0            2500 LE CONTE AVE
5001    ALLSTON WAY &amp; FIFTH ST
Name: BLKADDR, dtype: object</pre>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Final-Touchups">Final Touchups<a class="anchor-link" href="#Final-Touchups">&#182;</a></h3><p>This dataset seems almost ready for analysis. The Block_Location column seems to contain strings that record address, latitude, and longitude. We will want to separate the latitude and longitude for easier use.</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">split_lat_lon</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">calls</span><span class="p">[</span><span class="s1">&#39;Block_Location&#39;</span><span class="p">]</span>
        <span class="c1"># Get coords from string</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># Remove parens from coords</span>
        <span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Split latitude and longitude</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">})</span>
    <span class="p">)</span>

<span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">split_lat_lon</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>City</th>
      <th>State</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17091420</td>
      <td>BURGLARY AUTO</td>
      <td>07/23/2017 12:00:00 AM</td>
      <td>06:00</td>
      <td>...</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>37.876965</td>
      <td>-122.260544</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17020462</td>
      <td>THEFT FROM PERSON</td>
      <td>04/13/2017 12:00:00 AM</td>
      <td>08:45</td>
      <td>...</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>37.869363</td>
      <td>-122.268028</td>
    </tr>
  </tbody>
</table>
<p>2 rows  13 columns</p>
</div>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we can match the day of week number with its weekday:</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This DF contains the day for each number in CVDOW</span>
<span class="n">day_of_week</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/cvdow.csv&#39;</span><span class="p">)</span>
<span class="n">day_of_week</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CVDOW</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Sunday</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Monday</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Tuesday</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Wednesday</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Thursday</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>Friday</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>Saturday</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

  </div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">match_weekday</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">day_of_week</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;CVDOW&#39;</span><span class="p">)</span>
<span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">match_weekday</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>BLKADDR</th>
      <th>City</th>
      <th>State</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17091420</td>
      <td>BURGLARY AUTO</td>
      <td>07/23/2017 12:00:00 AM</td>
      <td>06:00</td>
      <td>...</td>
      <td>2500 LE CONTE AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>Sunday</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17038302</td>
      <td>BURGLARY AUTO</td>
      <td>07/02/2017 12:00:00 AM</td>
      <td>22:00</td>
      <td>...</td>
      <td>BOWDITCH STREET &amp; CHANNING WAY</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>Sunday</td>
    </tr>
  </tbody>
</table>
<p>2 rows  12 columns</p>
</div>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll drop columns we no longer need:</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">drop_unneeded_cols</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CVDOW&#39;</span><span class="p">,</span> <span class="s1">&#39;InDbDate&#39;</span><span class="p">,</span> <span class="s1">&#39;Block_Location&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;EVENTDT&#39;</span><span class="p">,</span> <span class="s1">&#39;EVENTTM&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we'll pipe the <code>calls</code> DF through all the functions we've defined:</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls_final</span> <span class="o">=</span> <span class="p">(</span><span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">combine_event_datetimes</span><span class="p">)</span>
               <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">split_lat_lon</span><span class="p">)</span>
               <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">match_weekday</span><span class="p">)</span>
               <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">drop_unneeded_cols</span><span class="p">))</span>
<span class="n">df_interact</span><span class="p">(</span><span class="n">calls_final</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    



  <div class="output_subarea output_widget_view ">
    <button class="js-nbinteract-widget">
      Loading widgets...
    </button>
  </div>

</div>

<div class="output_area">

    

<div class="output_subarea output_stream output_stdout output_text">
<pre>(5508 rows, 8 columns) total
</pre>
</div>
</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Calls dataset is now ready for further data analysis. In the next section, we will clean the Stops dataset.</p>

</div>
</div>
</div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Save data to CSV for other chapters</span>
<span class="c1"># calls_final.to_csv(&#39;../ch5/data/calls.csv&#39;, index=False)</span>
</pre></div>

    </div>
</div>
</div>

  </div>


</div>



          <nav class="c-page__nav">
  
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/ch/05/cleaning_intro.html">
       <span class="u-margin-right-tiny"></span> Previous
    </a>
  

  
    <a id="js-page__nav__next" class="c-page__nav__next" href="/ch/05/cleaning_stops.html">
      Next <span class="u-margin-right-tiny"></span> 
    </a>
  
</nav>

        </div>
      </main>
    </div>

    <script>
      window.ga =
  window.ga ||
  function() {
    ;(ga.q = ga.q || []).push(arguments)
  }
ga.l = +new Date()
ga('create', 'UA-113006011-1', 'auto')
ga('send', 'pageview')

    </script>
  </body>
</html>
