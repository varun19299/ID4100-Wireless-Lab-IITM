<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Principles and Techniques of Data Science</title>
  <meta name="description" content="This is the textbook for Data 100, the Principles and Techniques of Data Science course at UC Berkeley.
Data 100 is the upper-division, semester-long data science course that follows Data 8, the Foundations of Data Science. The reader's assumed background is detailed in the About This Book page.">

  <link rel="canonical" href="/ch/16/reg_ridge.html">
  <link rel="alternate" type="application/rss+xml" title="Principles and Techniques of Data Science" href="/feed.xml">

  <meta property="og:url"         content="/ch/16/reg_ridge.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Principles and Techniques of Data Science" />
<meta property="og:description" content="This is the textbook for Data 100, the Principles and Techniques of Data Science course at UC Berkeley.
Data 100 is the upper-division, semester-long data science course that follows Data 8, the Foundations of Data Science. The reader's assumed background is detailed in the About This Book page." />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "/ch/16/reg_ridge.html",
  "headline":
    "Principles and Techniques of Data Science",
  "datePublished":
    "2019-03-03T19:56:01+05:30",
  "dateModified":
    "2019-03-03T19:56:01+05:30",
  "description":
    "This is the textbook for Data 100, the Principles and Techniques of Data Science course at UC Berkeley.
Data 100 is the upper-division, semester-long data science course that follows Data 8, the Foundations of Data Science. The reader's assumed background is detailed in the About This Book page.",
  "author": {
    "@type": "Person",
    "name": "Sam Lau, Joey Gonzalez, and Deborah Nolan"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "",
    "height": 60,
    "width": 60
  }
}

  </script>

  <link rel="stylesheet" href="/assets/css/styles.css">

  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Allow inline math using $ and automatically break long math lines -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
      },
      CommonHTML: {
        linebreaks: {
          automatic: true,
        },
      },
    });
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/assets/js/turbolinks.js" async></script>

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Google analytics -->
  <script src="/assets/js/ga.js" async></script>
</head>

  <body>
    <!-- Show sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      




<nav id="js-sidebar" class="c-textbook__sidebar">
  <ul class="c-sidebar__chapters">
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="http://ds100.org/"
        >
          
          Data 100 Homepage
        </a>

        
      </li>

      
    

      
      
        <li class="c-sidebar__divider"></li>
        

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/"
        >
          
          Introduction
        </a>

        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/about_this_book.html"
        >
          
          About This Book
        </a>

        
      </li>

      
    

      
      
        <li class="c-sidebar__divider"></li>
        

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/01/lifecycle_intro.html"
        >
          
            1.
          
          The Data Science Lifecycle
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/01/lifecycle_students_1.html"
                >
                  
                    1.1
                    
                  
                  The Students of Data 100
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/01/lifecycle_students_2.html"
                >
                  
                    1.2
                    
                  
                  Exploring the Data
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/01/lifecycle_students_3.html"
                >
                  
                    1.3
                    
                  
                  What's in a Name?
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/02/design_intro.html"
        >
          
            2.
          
          Data Design
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/02/design_dewey_truman.html"
                >
                  
                    2.1
                    
                  
                  Dewey Defeats Truman
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/02/design_prob_overview.html"
                >
                  
                    2.2
                    
                  
                  Probability Overview
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/02/design_sampling.html"
                >
                  
                    2.3
                    
                  
                  Probability Sampling
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/02/design_srs_vs_big_data.html"
                >
                  
                    2.4
                    
                  
                  SRS vs. "Big Data"
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/03/pandas_intro.html"
        >
          
            3.
          
          Tabular Data and pandas
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/03/pandas_structure.html"
                >
                  
                    3.1
                    
                  
                  Structure
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/03/pandas_indexes.html"
                >
                  
                    3.2
                    
                  
                  Indexes, Slicing, and Sorting
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/03/pandas_grouping_pivoting.html"
                >
                  
                    3.3
                    
                  
                  Grouping and Pivoting
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/03/pandas_apply_strings_plotting.html"
                >
                  
                    3.4
                    
                  
                  Apply, Strings, and Plotting
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/04/eda_intro.html"
        >
          
            4.
          
          Exploratory Data Analysis
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/04/eda_data_types.html"
                >
                  
                    4.1
                    
                  
                  Data Types
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href=""
                >
                  
                    4.2
                    
                  
                  Distributions [in progress]
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href=""
                >
                  
                    4.3
                    
                  
                  Associations [in progress]
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/05/cleaning_intro.html"
        >
          
            5.
          
          Data Cleaning
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_calls.html"
                >
                  
                    5.1
                    
                  
                  Cleaning the Calls Dataset
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_stops.html"
                >
                  
                    5.2
                    
                  
                  Cleaning the Stops Dataset
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_structure.html"
                >
                  
                    5.3
                    
                  
                  Structure and Joins
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_granularity.html"
                >
                  
                    5.4
                    
                  
                  Granularity
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_scope.html"
                >
                  
                    5.5
                    
                  
                  Scope
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_temp.html"
                >
                  
                    5.6
                    
                  
                  Temporality
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/05/cleaning_faithfulness.html"
                >
                  
                    5.7
                    
                  
                  Faithfulness
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/06/viz_intro.html"
        >
          
            6.
          
          Data Visualization
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_quantitative.html"
                >
                  
                    6.1
                    
                  
                  Quantitative Data
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_qualitative.html"
                >
                  
                    6.2
                    
                  
                  Qualitative Data
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_matplotlib.html"
                >
                  
                    6.3
                    
                  
                  Customizing Plots
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_principles.html"
                >
                  
                    6.4
                    
                  
                  Principles of Visualization
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_principles_2.html"
                >
                  
                    6.5
                    
                  
                  Principles of Visualization 2
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/06/viz_philosophy.html"
                >
                  
                    6.6
                    
                  
                  Visualization Philosophy
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/07/web_intro.html"
        >
          
            7.
          
          Web Technologies
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/07/web_http.html"
                >
                  
                    7.1
                    
                  
                  HTTP
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/08/text_intro.html"
        >
          
            8.
          
          Working With Text
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/08/text_strings.html"
                >
                  
                    8.1
                    
                  
                  Python String Methods
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/08/text_regex.html"
                >
                  
                    8.2
                    
                  
                  Regular Expressions
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/08/text_re.html"
                >
                  
                    8.3
                    
                  
                  Regex in Python and pandas
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/09/sql_intro.html"
        >
          
            9.
          
          Databases and SQL
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/09/sql_rdbms.html"
                >
                  
                    9.1
                    
                  
                  Relational Databases
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/09/sql_basics.html"
                >
                  
                    9.2
                    
                  
                  SQL Queries
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/09/sql_joins.html"
                >
                  
                    9.3
                    
                  
                  SQL Joins
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/10/modeling_intro.html"
        >
          
            10.
          
          Modeling and Estimation
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/10/modeling_simple.html"
                >
                  
                    10.1
                    
                  
                  A Simple Model
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/10/modeling_loss_functions.html"
                >
                  
                    10.2
                    
                  
                  Loss Functions
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/10/modeling_abs_huber.html"
                >
                  
                    10.3
                    
                  
                  Absolute Cost and Huber Cost
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/11/gradient_descent.html"
        >
          
            11.
          
          Gradient Descent
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/11/gradient_basics.html"
                >
                  
                    11.1
                    
                  
                  Basic Numerical Optimization
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/11/gradient_descent_define.html"
                >
                  
                    11.2
                    
                  
                  Defining Gradient Descent
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/11/gradient_convexity.html"
                >
                  
                    11.3
                    
                  
                  Convexity
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/11/gradient_stochastic.html"
                >
                  
                    11.4
                    
                  
                  Stochastic Gradient Descent
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/12/prob_and_gen.html"
        >
          
            12.
          
          Probability and Generalization
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/12/prob_random_vars.html"
                >
                  
                    12.1
                    
                  
                  Random Variables
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/12/prob_exp_var.html"
                >
                  
                    12.2
                    
                  
                  Expectation and Variance
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/12/prob_risk.html"
                >
                  
                    12.3
                    
                  
                  Risk
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/13/linear_models.html"
        >
          
            13.
          
          Linear Regression
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/13/linear_tips.html"
                >
                  
                    13.1
                    
                  
                  Defining a Simple Linear Model
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/13/linear_grad.html"
                >
                  
                    13.2
                    
                  
                  Fitting the Model
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/13/linear_multiple.html"
                >
                  
                    13.3
                    
                  
                  Multiple Linear Regression
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/13/linear_projection.html"
                >
                  
                    13.4
                    
                  
                  A Geometric Perspective
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/13/linear_case_study.html"
                >
                  
                    13.5
                    
                  
                  Linear Regression Case Study
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/14/feature_engineering.html"
        >
          
            14.
          
          Feature Engineering
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/14/feature_one_hot.html"
                >
                  
                    14.1
                    
                  
                  One-Hot Encoding
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/14/feature_polynomial.html"
                >
                  
                    14.2
                    
                  
                  Polynomial Regression
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/15/bias_intro.html"
        >
          
            15.
          
          Bias-Variance Tradeoff
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/15/bias_risk.html"
                >
                  
                    15.1
                    
                  
                  Risk and Cost Minimization
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/15/bias_modeling.html"
                >
                  
                    15.2
                    
                  
                  Model Bias and Variance
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/15/bias_cv.html"
                >
                  
                    15.3
                    
                  
                  Cross Validation
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/16/reg_intro.html"
        >
          
            16.
          
          Regularization
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/16/reg_intuition.html"
                >
                  
                    16.1
                    
                  
                  Regularization Intuition
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/ch/16/reg_ridge.html"
                >
                  
                    16.2
                    
                  
                  L2 Regularization
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/16/reg_lasso.html"
                >
                  
                    16.3
                    
                  
                  L1 Regularization
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/17/classification_intro.html"
        >
          
            17.
          
          Classification
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_prob.html"
                >
                  
                    17.1
                    
                  
                  Regression on Probabilities
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_log_model.html"
                >
                  
                    17.2
                    
                  
                  Logistic Model
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_cost.html"
                >
                  
                    17.3
                    
                  
                  Cross-Entropy Loss
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_log_reg.html"
                >
                  
                    17.4
                    
                  
                  Using Logistic Regression
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_cost_justification.html"
                >
                  
                    17.5
                    
                  
                  Justifying Cross-Entropy Loss
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_sgd.html"
                >
                  
                    17.6
                    
                  
                  Fitting a Logistic Model
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_sensitivity_specificity.html"
                >
                  
                    17.7
                    
                  
                  Evaluating Logistic Models
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/17/classification_multiclass.html"
                >
                  
                    17.8
                    
                  
                  Multiclass Classification
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/18/hyp_intro.html"
        >
          
            18.
          
          Statistical Inference
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/18/hyp_introduction.html"
                >
                  
                    18.1
                    
                  
                  Introduction to Hypothesis Testing
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/18/hyp_introduction_part2.html"
                >
                  
                    18.2
                    
                  
                  Permutation Testing
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/18/hyp_regression.html"
                >
                  
                    18.3
                    
                  
                  Bootstrapping for Linear Regression
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/18/hyp_studentized.html"
                >
                  
                    18.4
                    
                  
                  Studentized Bootstrap
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/18/hyp_phacking.html"
                >
                  
                    18.5
                    
                  
                  P-Hacking
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      
        <li class="c-sidebar__divider"></li>
        

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/19/vector_space_review.html"
        >
          
          Appendix: Vector Space Review
        </a>

        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/20/ref_intro.html"
        >
          
          Appendix: Reference Tables
        </a>

        

          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/20/ref_pandas.html"
                >
                  
                  pandas
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/20/ref_seaborn.html"
                >
                  
                  seaborn
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/20/ref_matplotlib.html"
                >
                  
                  matplotlib
                </a>
              </li>
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ch/20/ref_sklearn.html"
                >
                  
                  scikit-learn
                </a>
              </li>
            
          </ul>
        
      </li>

      
    

      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ch/21/contributors.html"
        >
          
          Appendix: Contributors
        </a>

        
      </li>

      
    
  </ul>
</nav>


      <main class="c-textbook__page" tabindex="-1">
        <div class="o-wrapper c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

        <div class="o-wrapper">
          

<div id="ipython-notebook">
    <div class="buttons">
        <button class="interact-button js-nbinteract-widget">
            Show Widgets
        </button>
        <a class="interact-button" href="http://data100.datahub.berkeley.edu/user-redirect/git-pull?repo=https://github.com/DS-100/textbook&subPath=notebooks/16/reg_ridge.ipynb">Open on DataHub</a>
    </div>
    







  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/notebooks/16&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

  </div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c1"># Ignore numpy dtype warnings. These warnings are caused by an interaction</span>
<span class="c1"># between numpy and Cython and can be safely ignored.</span>
<span class="c1"># Reference: https://stackoverflow.com/a/40846742</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;numpy.dtype size changed&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;numpy.ufunc size changed&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option(&#39;display.float_format&#39;, &#39;{:.2f}&#39;.format)</span>
</pre></div>

    </div>
</div>
</div>

  </div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

  </div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;water_large.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

  </div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">namedtuple</span>
<span class="n">Curve</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Curve&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;xs&#39;</span><span class="p">,</span> <span class="s1">&#39;ys&#39;</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span> <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">subseq</span> <span class="ow">in</span> <span class="n">seq</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">subseq</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">x_start</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">x_end</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_end</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Curve</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_curve</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">curve</span><span class="o">.</span><span class="n">ys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_curves</span><span class="p">(</span><span class="n">curves</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;Deg </span><span class="si">{deg}</span><span class="s1"> poly&#39;</span> <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">curves</span><span class="p">)</span> <span class="o">/</span> <span class="n">cols</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                             <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">curve</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">axes</span><span class="p">),</span> <span class="n">curves</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="n">plot_data</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Training data&#39;</span><span class="p">)</span>
        <span class="n">plot_curve</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5e10</span><span class="p">,</span> <span class="mf">170e10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        
    <span class="c1"># add a big axes, hide frame</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># hide tick and tick label of the big axes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">,</span>
                    <span class="n">left</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Polynomial Regression&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Water Level Change (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Water Flow (Liters)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
</pre></div>

    </div>
</div>
</div>

  </div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">coefs</span><span class="p">(</span><span class="n">clf</span><span class="p">):</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;reg&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">coef_table</span><span class="p">(</span><span class="n">clf</span><span class="p">):</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">coefs</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Coefficient Value&#39;</span><span class="p">:</span> <span class="n">vals</span><span class="p">})</span>
            <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

  </div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>

<span class="n">degrees</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
                  <span class="p">(</span><span class="s1">&#39;reg&#39;</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())])</span>
        <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>

<span class="n">curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span> <span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">clfs</span><span class="p">]</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>

<span class="n">ridge_clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
                        <span class="p">(</span><span class="s1">&#39;reg&#39;</span><span class="p">,</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))])</span>
        <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>

<span class="n">ridge_curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span> <span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">ridge_clfs</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="L2-Regularization:-Ridge-Regression">L2 Regularization: Ridge Regression<a class="anchor-link" href="#L2-Regularization:-Ridge-Regression">&#182;</a></h2><p>In this section we introduce $ L_2 $ regularization, a method of penalizing large weights in our cost function to lower model variance. We briefly review linear regression, then introduce regularization as a modification to the cost function.</p>
<p>To perform least squares linear regression, we use the model:</p>
<p>$$
f_\hat{\theta}(x) = \hat{\theta} \cdot x
$$</p>
<p>We fit the model by minimizing the mean squared error cost function:</p>
<p>$$
\begin{aligned}
L(\hat{\theta}, X, y)
&amp;= \frac{1}{n} \sum_{i}^n(y_i - f_\hat{\theta} (X_i))^2\\
\end{aligned}
$$</p>
<p>In the above definitions, $ X $ represents the $ n \times p $ data matrix, $ x $ represents a row of $ X $, $ y $ represents the observed outcomes, and $ \hat{\theta} $ represents the model weights.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="L2-Regularization-Definition">L2 Regularization Definition<a class="anchor-link" href="#L2-Regularization-Definition">&#182;</a></h2><p>To add $ L_2 $ regularization to the model, we modify the cost function above:</p>
<p>$$
\begin{aligned}
L(\hat{\theta}, X, y)
&amp;= \frac{1}{n} \sum_{i}(y<em>i - f</em>\hat{\theta} (X_i))^2</p>

<pre><code>+ \lambda \sum_{j = 1}^{p} \hat{\theta_j}^2
</code></pre>
<p>\end{aligned}
$$</p>
<p>Notice that the cost function above is the same as before with the addition of the $ L_2 $ regularization $ \lambda \sum_{j = 1}^{p} \hat{\theta_j}^2 $ term. The summation in this term sums the square of each model weight $ \hat{\theta_1}, \hat{\theta_2}, \ldots, \hat{\theta_p} $. The term also introduces a new scalar model parameter $ \lambda $ that adjusts the regularization penalty.</p>
<p>The regularization term causes the cost to increase if the values in $ \hat{\theta} $ are further away from 0. With the addition of regularization, the optimal model weights minimize the combination of loss and regularization penalty rather than the loss alone. Since the resulting model weights tend to be smaller in absolute value, the model has lower variance and higher bias.</p>
<p>Using $ L_2 $ regularization with a linear model and the mean squared error cost function is also known more commonly as <strong>ridge regression</strong>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Regularization-Parameter">The Regularization Parameter<a class="anchor-link" href="#The-Regularization-Parameter">&#182;</a></h3><p>The regularization parameter $ \lambda $ controls the regularization penalty. A small $ \lambda $ results in a small penaltyif $ \lambda = 0 $ the regularization term is also $ 0 $ and the cost is not regularized at all.</p>
<p>A large $ \lambda $ terms results in a large penalty and therefore a simpler model. Increasing $ \lambda $ decreases the variance and increases the bias of the model. We use cross-validation to select the value of $ \lambda $ that minimizes the validation error.</p>
<p><strong>Note about regularization in <code>scikit-learn</code>:</strong></p>
<p><code>scikit-learn</code> provides regression models that have regularization built-in. For example, to conduct ridge regression you may use the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html"><code>sklearn.linear_model.Ridge</code></a> regression model. Note that <code>scikit-learn</code> models call the regularization parameter <code>alpha</code> instead of $ \lambda $.</p>
<p><code>scikit-learn</code> conveniently provides regularized models that perform cross-validation to select a good value of $ \lambda $. For example, the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.RidgeCV.html#sklearn.linear_model.RidgeCV"><code>sklearn.linear_model.RidgeCV</code></a> allows users to input regularization parameter values and will automatically use cross-validation to select the parameter value with the least validation error.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bias-Term-Exclusion">Bias Term Exclusion<a class="anchor-link" href="#Bias-Term-Exclusion">&#182;</a></h3><p>Note that the bias term $ \theta_0 $ is not included in the summation of the regularization term. We do not penalize the bias term because increasing the bias term does not increase the variance of our modelthe bias term simply shifts all predictions by a constant value.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Data-Normalization">Data Normalization<a class="anchor-link" href="#Data-Normalization">&#182;</a></h3><p>Notice that the regularization term $ \lambda \sum_{j = 1}^{p} \hat{\theta_j}^2 $ penalizes each $ \hat{\theta_j} $ equally. However, the effect of each $ \hat{\theta_j} $ differs depending on the data itself. Consider this section of the water flow dataset after adding degree 8 polynomial features:</p>

</div>
</div>
</div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clfs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;poly&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">]),</span>
             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;deg_</span><span class="si">{n}</span><span class="s1">_feat&#39;</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>deg_0_feat</th>
      <th>deg_1_feat</th>
      <th>...</th>
      <th>deg_6_feat</th>
      <th>deg_7_feat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-15.94</td>
      <td>253.98</td>
      <td>...</td>
      <td>-261095791.08</td>
      <td>4161020472.12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-29.15</td>
      <td>849.90</td>
      <td>...</td>
      <td>-17897014961.65</td>
      <td>521751305227.70</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36.19</td>
      <td>1309.68</td>
      <td>...</td>
      <td>81298431147.09</td>
      <td>2942153527269.12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>37.49</td>
      <td>1405.66</td>
      <td>...</td>
      <td>104132296999.30</td>
      <td>3904147586408.71</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-48.06</td>
      <td>2309.65</td>
      <td>...</td>
      <td>-592123531634.12</td>
      <td>28456763821657.78</td>
    </tr>
  </tbody>
</table>
<p>5 rows  8 columns</p>
</div>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the degree 7 polynomial features have much larger values than the degree 1 features. This means that a large model weight for the degree 7 features affects the predictions much more than a large model weight for the degree 1 features. If we apply regularization to this data directly, the regularization penalty will disproportionately lower the model weight for the lower degree features. In practice, this often results in high model variance even after applying regularization since the features with large effect on prediction will not be affected.</p>
<p>To combat this, we <em>normalize</em> each data column by subtracting the mean and scaling the values in each column to be between -1 and 1. In <code>scikit-learn</code>, most regression models allow initializing with <code>normalize=True</code> to normalize the data before fitting.</p>
<p>Another analogous technique is <em>standardizing</em> the data columns by subtracting the mean and dividing by the standard deviation for each data column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-Ridge-Regression">Using Ridge Regression<a class="anchor-link" href="#Using-Ridge-Regression">&#182;</a></h2><p>We have previously used polynomial features to fit polynomials of degree 2, 8, and 12 to water flow data. The original data and resulting model predictions are repeated below.</p>

</div>
</div>
</div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>water_level_change</th>
      <th>water_flow</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-15.94</td>
      <td>60422330445.52</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-29.15</td>
      <td>33214896575.60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36.19</td>
      <td>972706380901.06</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>7.09</td>
      <td>236352046523.78</td>
    </tr>
    <tr>
      <th>21</th>
      <td>46.28</td>
      <td>1494256381086.73</td>
    </tr>
    <tr>
      <th>22</th>
      <td>14.61</td>
      <td>378146284247.97</td>
    </tr>
  </tbody>
</table>
<p>23 rows  2 columns</p>
</div>
</div>

</div>

</div>
</div>

  </div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plot_curves</span><span class="p">(</span><span class="n">curves</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    



<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_ridge_16_0.png"
>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To conduct ridge regression, we first extract the data matrix and the vector of outcomes from the data:</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;y: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    

<div class="output_subarea output_stream output_stdout output_text">
<pre>X: 
[[-15.94]
 [-29.15]
 [ 36.19]
 ...
 [  7.09]
 [ 46.28]
 [ 14.61]]

y: 
[6.04e+10 3.32e+10 9.73e+11 ... 2.36e+11 1.49e+12 3.78e+11]
</pre>
</div>
</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we apply a degree 12 polynomial transform to <code>X</code>:</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>

<span class="c1"># We need to specify include_bias=False since sklearn&#39;s classifiers</span>
<span class="c1"># automatically add the intercept term.</span>
<span class="n">X_poly_8</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First two rows of transformed X:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_poly_8</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    

<div class="output_subarea output_stream output_stdout output_text">
<pre>First two rows of transformed X:
[[-1.59e+01  2.54e+02 -4.05e+03  6.45e+04 -1.03e+06  1.64e+07 -2.61e+08
   4.16e+09]
 [-2.92e+01  8.50e+02 -2.48e+04  7.22e+05 -2.11e+07  6.14e+08 -1.79e+10
   5.22e+11]]
</pre>
</div>
</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We specify <code>alpha</code> values that <code>scikit-learn</code> will select from using cross-validation, then use the <code>RidgeCV</code> classifier to fit the transformed data.</p>

</div>
</div>
</div>

  

  <div class="
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">RidgeCV</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>

<span class="c1"># Remember to set normalize=True to normalize data</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_poly_8</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Display the chosen alpha value:</span>
<span class="n">clf</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    



<div class="output_text output_subarea output_execute_result">
<pre>0.1</pre>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we plot the model predictions for the base degree 8 polynomial classifier next to the regularized degree 8 classifier:</p>

</div>
</div>
</div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">()</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Base degree 8 polynomial&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">()</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">ridge_curves</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Regularized degree 8 polynomial&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    



<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_ridge_24_0.png"
>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the regularized polynomial is smoother than the base degree 8 polynomial and still captures the major trend in the data.</p>
<p>Comparing the coefficients of the non-regularized and regularized models shows that ridge regression favors placing model weights on the lower degree polynomial terms:</p>

</div>
</div>
</div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">coef_table</span><span class="p">(</span><span class="n">clfs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Coefficient Value&#39;</span><span class="p">:</span> <span class="s1">&#39;Base&#39;</span><span class="p">})</span>
<span class="n">ridge</span> <span class="o">=</span> <span class="n">coef_table</span><span class="p">(</span><span class="n">ridge_clfs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Coefficient Value&#39;</span><span class="p">:</span> <span class="s1">&#39;Regularized&#39;</span><span class="p">})</span>

<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">display</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ridge</span><span class="p">))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Base</th>
      <th>Regularized</th>
    </tr>
    <tr>
      <th>degree</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>225782472111.94</td>
      <td>221063525725.23</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13115217770.78</td>
      <td>6846139065.96</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-144725749.98</td>
      <td>146158037.96</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-10355082.91</td>
      <td>1930090.04</td>
    </tr>
    <tr>
      <th>4</th>
      <td>567935.23</td>
      <td>38240.62</td>
    </tr>
    <tr>
      <th>5</th>
      <td>9805.14</td>
      <td>564.21</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-249.64</td>
      <td>7.25</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-2.09</td>
      <td>0.18</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.03</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Repeating the process for degree 12 polynomial features results in a similar result:</p>

</div>
</div>
</div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">()</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Base degree 12 polynomial&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5e10</span><span class="p">,</span> <span class="mf">170e10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">()</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">ridge_curves</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Regularized degree 12 polynomial&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5e10</span><span class="p">,</span> <span class="mf">170e10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    



<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_ridge_28_0.png"
>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Increasing the regularization parameter results in progressively simpler models. The plot below demonstrates the effects of increasing the regularization amount from 0.001 to 100.0.</p>

</div>
</div>
</div>

  

  <div class="nbinteract-hide_in
      cell border-box-sizing code_cell rendered">
    <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">]</span>

<span class="n">alpha_clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;reg&#39;</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))]</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">]</span>

<span class="n">alpha_curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span> <span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">alpha_clfs</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">lambda = </span><span class="si">{alpha}</span><span class="s1">$&#39;</span> <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">]</span>

<span class="n">plot_curves</span><span class="p">(</span><span class="n">alpha_curves</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    



<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_ridge_30_0.png"
>
</div>

</div>

</div>
</div>

  </div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, increasing the regularization parameter increases the bias of our model. If our parameter is too large, the model becomes a constant model because any non-zero model weight is heavily penalized.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">&#182;</a></h2><p>Using $ L_2 $ regularization allows us to tune model bias and variance by penalizing large model weights. $ L_2 $ regularization for least squares linear regression is also known by the more common name ridge regression. Using regularization adds an additional model parameter $ \lambda $ that we adjust using cross-validation.</p>

</div>
</div>
</div>


</div>



          <nav class="c-page__nav">
  
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/ch/16/reg_intuition.html">
       <span class="u-margin-right-tiny"></span> Previous
    </a>
  

  
    <a id="js-page__nav__next" class="c-page__nav__next" href="/ch/16/reg_lasso.html">
      Next <span class="u-margin-right-tiny"></span> 
    </a>
  
</nav>

        </div>
      </main>
    </div>

    <script>
      window.ga =
  window.ga ||
  function() {
    ;(ga.q = ga.q || []).push(arguments)
  }
ga.l = +new Date()
ga('create', 'UA-113006011-1', 'auto')
ga('send', 'pageview')

    </script>
  </body>
</html>
